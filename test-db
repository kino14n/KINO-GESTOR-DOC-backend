from flask import jsonify
import db


@app.route("/api/test-db")
def test_db():
    try:
        conn = db.get_conn()
        cursor = conn.cursor()
        cursor.execute("SELECT COUNT(*) AS total FROM documentos")
        row = cursor.fetchone()
        return jsonify({
            "status": "ok",
            "total_documentos": row["total"],
        })
    except Exception as e:
        return jsonify({
            "status": "error",
            "message": str(e),
        }), 500